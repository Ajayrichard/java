pipeline {
	agent any
	tools {
		maven 'maven'
	}
	stages {
		stage ('Git-Fetch') {
			steps {
				git 'git@github.com:mohancggrl/hello-world-war.git'
			}
		}
		stage ('build') {
			steps {
				sh 'mvn clean package'
			}
		}
		stage ('upload_to Nexus') {
			steps {
				script {
					def pom = readMavenPom file: 'pom.xml'
					nexusArtifactUploader artifacts: [
					[
						artifactId: 'hello-world-war',
						classifier: '', 
						file: "target/hello-world-war-${pom.version}.war", 
						type: 'war'
					]
				], 
				credentialsId: 'Nexus3', 
				groupId: 'com.efsavage', 
				nexusUrl: '172.31.8.254:8081', 
				nexusVersion: 'nexus3', 
				protocol: 'http', 
				repository: 'mouni', 
				version: "${pom.version}"
				}
			}
		}
	}
}
